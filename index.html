<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Manual Index</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #f9f9f9; }
    h1 { color: #333; }
    ul { list-style: none; padding-left: 1em; }
    li { margin: 0.3em 0; }
    a { text-decoration: none; color: #0066cc; }
    a:hover { text-decoration: underline; }
    .topic { font-weight: bold; margin-top: 1em; }
  </style>
</head>
<body>
  <h1>üìö Manual Index</h1>
  <p>Alle Anleitungen aus <code>manual/</code> sind hier ausw√§hlbar:</p>

  <div id="index">‚è≥ Lade Inhalte‚Ä¶</div>

  <script>
    const repoOwner = "florianthepro";
    const repoName = "manual";
    const branch = "main";
    const baseUrl = `https://github.com/${repoOwner}/${repoName}/blob/${branch}/`;

    async function fetchTree() {
      const url = `https://api.github.com/repos/${repoOwner}/${repoName}/git/trees/${branch}?recursive=1`;
      const res = await fetch(url);
      return res.json();
    }

    function buildIndex(files) {
      const container = document.getElementById("index");
      const structure = {};

      // Nur Dateien unter manual/ ber√ºcksichtigen
      files.forEach(file => {
        if (file.path.startsWith("manual/") && file.path.endsWith(".md")) {
          const parts = file.path.split("/");
          // manual/thema/kategorie/sprache.md
          if (parts.length === 4) {
            const [_, thema, kategorie, spracheFile] = parts;
            const sprache = spracheFile.replace(".md", "");
            structure[thema] = structure[thema] || {};
            structure[thema][kategorie] = structure[thema][kategorie] || [];
            structure[thema][kategorie].push({
              lang: sprache,
              url: baseUrl + file.path
            });
          }
        }
      });

      const ul = document.createElement("ul");
      for (const thema in structure) {
        const themaLi = document.createElement("li");
        themaLi.innerHTML = `<span class="topic">üîπ ${thema}</span>`;
        const catUl = document.createElement("ul");

        for (const kategorie in structure[thema]) {
          const catLi = document.createElement("li");
          catLi.innerHTML = `üìÇ ${kategorie}`;
          const langUl = document.createElement("ul");

          structure[thema][kategorie].forEach(entry => {
            const langLi = document.createElement("li");
            langLi.innerHTML = `<a href="${entry.url}" target="_blank">üåê ${entry.lang.toUpperCase()}</a>`;
            langUl.appendChild(langLi);
          });

          catLi.appendChild(langUl);
          catUl.appendChild(catLi);
        }

        themaLi.appendChild(catUl);
        ul.appendChild(themaLi);
      }

      container.innerHTML = "";
      container.appendChild(ul);
    }

    fetchTree().then(data => buildIndex(data.tree));
  </script>
</body>
</html>
